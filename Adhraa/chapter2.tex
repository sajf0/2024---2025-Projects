\chapter{طريقة التغاير التكراري}

\section{تعريف طريقة التغاير التكراري}

طريقة التغاير التكراري هي اجراء تكراري للحصول على حل تقريبي (بالغالب متقارب بسرعة) لمعادلة تفاضلية خطية او غير خطية. وتتلخص فكرتها الاساسية في انشاء دالة تصحيحية تعمل على تحسين التخمين الاولي من خلال دمج مضروب لاكرانج المحدد من نظرية التغاير.

\section{عرض الطريقة}

لتكن لدينا المعادلة الدالية من الشكل 
\[
L[u(x)] + N[u(x)] = g(x)
\]
حيث
\begin{itemize}
	\item $L$ المؤثر الخطي.
	\item $N$ المؤثر غير الخطي.
	\item $g(x)$ دالة معروفة.
	\item $u(x)$ الدالة المجهولة التي يجب تحديدها.
\end{itemize}

\subsection*{المخطط التكراري}

طريقة التغاير التكراري تولد متتابعة من الدوال $u_n(x)$ تتقارب الى الحل $u(x)$ من خلال انشاء دالي تصحيحي كالآتي
\[
u_{n+1}(x) = u_n(x) + \int_a^b \lambda(s) \big[L[u_n(s)] + N[\tilde{u}_n(s)] - g(s)\big] \, ds
\]
حيث
\begin{itemize}
	\item $u_n(x)$ هي التقريب الحالي.
	\item $\lambda(s)$ مضروب لاكرانج الذي يتحدد من خلال نظرية التغاير.
	\item $\tilde{u}_n(s)$ يمثل التغاير المقيد لــ $u_n(x)$، اي ان من خلال الاجراء التكراري نعتبر $\delta\tilde{u}_n(s) = 0$
\end{itemize}

\subsection*{طريقة التغاير التكراري للمعادلات التفاضلية الجزئية}
لتكن لدينا المعادلة التفاضلية الجزئية من الشكل
\[
L[u(x, t)] + N[u(x, t)] = g(x, t)
\]
حيث
\begin{itemize}
	\item $L$ المؤثر الخطي.
	\item $N$ المؤثر غير الخطي.
	\item $g(x, t)$ دالة معروفة.
	\item $u(x, t)$ الدالة المجهولة التي يجب تحديدها.
\end{itemize}
الصيغة التكرارية تكون على الصورة

\begin{equation}
	u_{n+1}(x, t) = u_n(x, t) + \int_{0}^{t} \lambda(s) \big[L[u_n(x, s)] + N[\tilde{u}_n(x, s)] - g(x, s)\big] \, ds 
\end{equation}
حيث
\begin{itemize}
	\item $u_n(x, t)$ هي التقريب الحالي.
	\item $\lambda(s)$ مضروب لاكرانج الذي يتحدد من خلال نظرية التغاير.
	\item $\tilde{u}_n(x, s)$ يمثل التغاير المقيد لــ $u_n(x)$، اي ان من خلال الاجراء التكراري نعتبر \\$\delta\tilde{u}_n(x, s) = 0$
\end{itemize}

\newpage

\section{بعض الامثلة}

\begin{example}
	حل المعادلة التالية بإستخدام طريقة التغاير التكراري
	\[
	u_t + u u_x = 0 , \qquad u(x, 0) = -x
 	\]
\end{example}
\noindent
\textbf{الحل}\\
\noindent
من خلال (1) الصيغة التكرارية تكون 
\begin{equation}
u_{n+1}(x, t) = u_n(x, t) + \int_{0}^{t} \lambda(s) \left[\frac{\partial u_n}{\partial s} + \tilde{u}  \frac{\partial \tilde{u}_n}{\partial x}\right] \, ds 
\end{equation}
بأخذ التغاير لطرفي المعادلة (2) نحصل على
\begin{align}
	\delta u_{n+1} &= \delta u_n + \int_{0}^{t} \lambda(s) \left[\delta\left(\frac{\partial u_n}{\partial s}\right) + \delta \left(\tilde{u}  \frac{\partial \tilde{u}_n}{\partial x}\right)\right]\, ds\notag\\
	&= \delta u_n + \int_{0}^t \lambda(s) \delta\left(\frac{\partial u_n}{\partial s}\right) \, ds + \int_{0}^{t} \lambda(s) \delta \left(\tilde{u}  \frac{\partial \tilde{u}_n}{\partial x}\right) \, ds
\end{align}
وبما ان $\delta\tilde{u}_n = 0$ فإن التكامل الثاني يساوي صفراً. اذن الصيغة (3) تصبح 
\begin{equation}
	\delta u_{n+1} = \delta u_n + \int_{0}^{t} \lambda(s) \frac{\partial(\delta u_n)}{\partial s} \, ds
\end{equation} 
بإجراء التكامل بالاجزاء على التكامل في (4) نحصل على
\begin{align*}
	\delta u_{n+1} &= \delta u_n + \lambda(t) \delta u_n - \int_0^t \frac{d \lambda}{ds} \delta u_n \, ds\\
	&= [1 + \lambda(t)] \delta u_n - \int_0^t \frac{d \lambda}{ds} \delta u_n \, ds
\end{align*}
الآن بجعل $\delta u_{n+1} = 0$ يجب ان نجعل معاملات $\delta u_n$ تساوي صفراُ في الطرف الايمن نحصل على الشروط
\begin{equation}
	\begin{cases}
	\dfrac{d \lambda}{ds} = 0 \\
	1 + \lambda(t) = 0
\end{cases}
\end{equation}
بحل النظام (5) نحصل على مضروب لاكرانج $\lambda(s) = -1$. بالتعويض في (2) نحصل على الصيغة التكرارية 
\begin{equation}
	u_{n+1}(x, t) = u_n(x, t) - \int_{0}^{t} \frac{\partial u_n}{\partial s} + {u}_n  \frac{\partial {u}_n}{\partial x}\, ds 
\end{equation}
الآن نفرض $u_0(x,t) = -x$ و نحسب $u_1(x, t)$ من خلال العلاقة التكرارية (6)
\begin{align*}
	u_1(x, t) &= u_0(x, t) - \int_{0}^t \frac{\partial u_0}{\partial s} + u_0 \frac{\partial u_0}{\partial x} \, ds\\
	&= -x - \int_{0}^t 0 + (-x)(-1) \, ds\\
	&= -x - \int_{0}^t x \, ds\\
	&= -x - sx \Big|_0^t\\
	&= -x -tx\\
	&= -x(1+t)
\end{align*}
نجد $u_2(x, t)$
\begin{align*}
	u_2(x, t) &= u_1(x, t) - \int_{0}^t \frac{\partial u_1}{\partial s} + u_1 \frac{\partial u_1}{\partial x} \, ds\\
	&= -x(1+t) - \int_{0}^t -x + \big[-x(1+s)\big]\big[-(1+s)\big]\, ds\\
	&= -x(1+t) - \int_{0}^t -x + x(1+s)^2\, ds\\
	&= -x(1+t) - \left[-sx + \frac{x(1+s)^3}{3}\right]_0^t\\
	&= -x(1+t) - \left[-tx + \frac{x(1+t)^3}{3} - \frac{x}{3}\right]\\
	&= -x -xt + tx - \frac{x(1+3t + 3t^2 + t^3)}{3} + \frac{x}{3}\\
	&= -x - x \left(\frac{1}{3} + t + t^2 + \frac{t^3}{3} - \frac{1}{3}\right) \\
	&= -x \left(1+t+t^2 + \frac{t^3}{3}\right)
\end{align*}
نلاحظ عندما $n \to \infty$ فإن 
\[
u_n(x ,t) \to -x (1+t+t^2+t^3+t^4 + \cdots) = \frac{-x}{1-t} , \quad |t| < 1
\]
وهو يمثل الحل الحقيقي ويمكننا التحقق من ذلك كالآتي
\[
u_t + u u_x = \frac{-x}{(1-t)^2} + \left(\frac{-x}{1-t}\right)\left(\frac{-1}{1-t}\right) = \frac{-x}{(1-x)^2} + \frac{x}{(1-t)^2} = 0
\]

\begin{example}
	اوجد حل المعادلة التفاضلية بطريقة التغاير التكراري
	\[
	u_t = x^2 + \frac{1}{4} u_x^2,\quad u(x, 0) =0
	\]
\end{example}
\noindent
\textbf{الحل}\\
\noindent
من خلال الصيغة (1) لدينا الصيغة التكرارية
\begin{equation}
	u_{n+1} = u_n + \int_{0}^{t} \lambda(s) \left[\frac{\partial u_n}{\partial s} - \frac{1}{4}\left(\frac{\partial \tilde{u}_n}{\partial x}\right)^2 - x^2\right] \, ds
\end{equation}
بأخذ التغاير لطرفي المعادلة (7) ، نحصل على 
\begin{align*}
	\delta u_{n+1}= \delta u_n + \delta \int_{0}^{t} \lambda(s) \left[\frac{\partial u_n}{\partial s} - \frac{1}{4}\left(\frac{\partial \tilde{u}_n}{\partial x}\right)^2 - x^2\right] \, ds
\end{align*}
بطريقة مشابهة للمثال 1 - 2 ، نحصل على الشروط 
\begin{equation}
	\begin{cases}
		\dfrac{d \lambda}{ds} = 0 \\
		1 + \lambda(t) = 0
	\end{cases}
\end{equation}
ومنه نحصل على $\lambda(s)=-1$ ، بالتعويض في الصيغة التكرارية (7)
\begin{equation}
		u_{n+1} = u_n - \int_{0}^{t}  \left[\frac{\partial u_n}{\partial s} - \frac{1}{4}\left(\frac{\partial \tilde{u}_n}{\partial x}\right)^2 - x^2\right] \, ds
\end{equation}
الآن نفرض $u_0=0 $ و نحسب $u_1$ من خلال العلاقة التكرارية (9) عندما $n=0$
\begin{align*}
			u_{1} &= u_0 - \int_{0}^{t}  \left[\frac{\partial u_0}{\partial s} - \frac{1}{4}\left(\frac{\partial \tilde{u}_0}{\partial x}\right)^2  - x^2\right] \, ds\\
			&= 0 - \int_{0}^{t} -x^2 \, dt
			= x^2 s\Big|^t_0 = x^2t
\end{align*}
عندما $n=1$
\begin{align*}
		u_{2} &= u_1 - \int_{0}^{t}  \left[\frac{\partial u_1}{\partial s} - \frac{1}{4}\left(\frac{\partial \tilde{u}_1}{\partial x}\right)^2  - x^2\right] \, ds\\
		&= x^2 t - \int_{0}^t x^2 - \frac{1}{4}(2xs)^2 - x^2 \, ds\\
		&= x^2 t - \int_{0}^{t} x^2s^2\, ds\\
		&= x^2 t + x^2 \frac{t^3}{3}\\
		&= x^2 \left[t + \frac{t^3}{3}\right]
\end{align*}
عندما $n=2$ 
\begin{align*}
		u_{3} &= u_2 - \int_{0}^{t}  \left[\frac{\partial u_2}{\partial s} - \frac{1}{4}\left(\frac{\partial \tilde{u}_2}{\partial x}\right)^2 - x^2\right] \, ds\\
		&= x^2\left[t + \frac{t^3}{3}\right] - \int_{0}^{t} x^2(1+s^2) - \frac{1}{4}\left[2x(s + \frac{s^3}{3})\right] - x^2\,ds\\
		&= x^2\left[t + \frac{t^3}{3}\right] - \int_{0}^{t} x^2 + x^2s^2 - x^2 \left[s^2+\frac{2s^4}{3} + \frac{s^6}{9}\right] - x^2\, ds\\
		&= x^2\left[t + \frac{t^3}{3}\right]  - \int_{0}^{t} -\frac{2}{3} x^2 s^4 - \frac{1}{9} x^2s^6 \, ds\\
		&= x^2\left[t + \frac{t^3}{3}\right] + \left[\frac{2}{15}x^2s^5 + \frac{1}{63} x^2s^7\right]^t_0\\
		&= x^2\left[t + \frac{t^3}{3}\right] + \left[\frac{2}{15}x^2t^5 + \frac{1}{63} x^2t^7\right]\\
		&= x^2 \left[t + \frac{t^3}{3} + \frac{2t^5}{15} + \frac{t^7}{63}\right]
\end{align*}
نلاحظ عندما $n\to \infty$ فإن 
\[
u_n(x, t) \to x^2 \tan(t)
\]
وهو يمثل الحل الدقيق للمعادلة التفاضلية الاصلية.\\
للتحقق من ذلك 
\begin{align*}
	\frac{\partial u}{\partial t} - \frac{1}{4} \left(\frac{\partial u}{\partial x}\right)^2 - x^2 &= x^2\sec^2 t - \frac{1}{4}\left(2x\tan t\right)^2 - x^2\\
	&= x^2 \sec^2 t - x^2\tan^2 t - x^2\\
	&= x^2 (\sec^2 t - \tan^2 t) - x^2\\
	& = x^2 - x^2\\
	&=0 
\end{align*}

